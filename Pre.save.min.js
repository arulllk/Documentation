blogSchema.pre("save",(async function(next){if(!this.isModified(this.title))return next();const slugBase=this.title.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"");let slug=slugBase,suffix=1;for(;await mongoose.models.Blog.findOne({slug:slug});)slug=`${slugBase}-1`;this.slug=slug,next()})),userSchema.pre("save",(async function(next){const salt=await bcrypt.genSalt(10);this.password=await bcrypt.hash(this.password,salt),next()})),userSchema.methods.createJWT=function(){return jwt.sign({userId:this._id,name:this.name},process.env.JWT_SECRET,{expiresIn:process.env.JWT_LIFETIME})},userSchema.methods.comparePassword=async function(candidatePassword){const isMatch=await bcrypt.compare(candidatePassword,this.password);return isMatch};